{"info":{"author":"jlmadurga","author_email":"jlmadurga@gmail.com","bugtrack_url":null,"classifiers":["Development Status :: 4 - Beta","Framework :: Pytest","Programming Language :: Python","Programming Language :: Python :: 3","Programming Language :: Python :: 3.10","Programming Language :: Python :: 3.11","Programming Language :: Python :: 3.8","Programming Language :: Python :: 3.9"],"description":"pytest-tinybird\n===================================\n\nA pytest plugin to report test results to Tinybird. At the end of every run, this plugin posts results using the [Tinybird Events API](https://www.tinybird.co/docs/ingest/events-api.html). \n\n[![PyPI version](https://badge.fury.io/py/pytest-tinybird.svg)](https://badge.fury.io/py/pytest-tinybird)\n![Passed](https://github.com/jlmadurga/pytest-tinybird/actions/workflows/main.yml/badge.svg)\n![Top test passed](https://img.shields.io/endpoint?url=https://api.tinybird.co/v0/pipes/top_test_passed.ndjson?token=p.eyJ1IjogIjNhZjhlMTBhLTM2MjEtNDQ3OC04MWJmLTE5MDQ5N2UwNjBjYiIsICJpZCI6ICJkNDNmZGQ2Ni03NzY1LTQzZGYtYjEyNS0wYzNjYWJiMDgxZjUifQ.yWypEczMfJlgkjNt29pCf45XaxE1dMOr-oznll5tjpY)\n\n\n\nRequirements\n------------\n\n- Python >=3.8\n- pytest 3.8 or newer (previous versions might be compatible)\n- [Tinybird account](https://www.tinybird.co/) and a [token with append permissions](https://www.tinybird.co/docs/concepts/auth-tokens.html?highlight=token#auth-token-scopes)\n\n\nInstallation\n------------\n\npypi install package: https://pypi.org/project/pytest-tinybird/\n\nYou can install the plugin with the following bash command:\n\n```bash\n  $ pip install pytest-tinybird\n```\n\n\nUsage\n------------\n\nYou just need your [Tinybird](https://www.tinybird.co/) account and a Token with append permissions\n\nSet these env variables:\n\n```bash\nexport TINYBIRD_URL=<https://api.tinybird.co|https://api.us-east.tinybird.co>   # depends on your region\nexport TINYBIRD_DATASOURCE=<datasource_name>  # will be created with first results posted\nexport TINYBIRD_TOKEN=<token_with_append_permissions>\n```\n\nThen run pytest with `--report-to-tinybird`.\n\n\n```bash\n$ pytest tests --report-to-tinybird\n```\n\nCI execution info can also be set using some env variables. These are from GitLab:\n\n```bash\nCI_COMMIT_SHA\nCI_COMMIT_BRANCH\nCI_JOB_ID\nCI_JOB_NAME\nCI_JOB_URL\n```\n\nIf you are not using GitLab, you will need to set them manually. For instance, for GitHub actions you can check our current [GitHub actions workflow](https://github.com/tinybirdco/pytest-tinybird/blob/master/.github/workflows/main.yml).\n\nData Source details\n--------------------\n\nThe `pytest-tinybird` plugin creates and sends `report` objects via the [Events API](https://www.tinybird.co/docs/ingest/events-api.html) with this structure:\n\n```\n{\n\t'date': now,\n\t'commit': self.commit,\n\t'branch': self.branch,\n\t'job_id': self.job_id,\n\t'job_url': self.job_url,\n\t'job_name': self.job_name,\n\t'test_nodeid': test.nodeid,\n\t'test_name': test.head_line,\n\t'test_part': test.when,\n\t'duration': test.duration,\n\t'outcome': test.outcome\n}\n```\n\nWhen a `report` object is first sent to Tinybird, a Data Source with the following definition and schema is created:\n\n```sql\nTOKEN \"pytest-executor-write\" APPEND\n\nSCHEMA >\n    `commit` String `json:$.commit`,\n    `branch` String `json:$.branch`,\n    `date` DateTime `json:$.date`,\n    `duration` Float32 `json:$.duration`,\n    `job_id` String `json:$.job_id`,\n    `job_name` String `json:$.job_name`,\n    `job_url` String `json:$.job_url`,\n    `outcome` LowCardinality(String) `json:$.outcome`,\n    `test_name` String `json:$.test_name`,\n    `test_nodeid` String `json:$.test_nodeid`,\n    `test_part` LowCardinality(String) `json:$.test_part`\n\nENGINE MergeTree\nENGINE_PARTITION_KEY toYYYYMM(date)\n```\n\nYou can also see the Data Source schema with this [data sample](https://api.tinybird.co/v0/pipes/ci_tests_sample.json?token=p.eyJ1IjogIjNhZjhlMTBhLTM2MjEtNDQ3OC04MWJmLTE5MDQ5N2UwNjBjYiIsICJpZCI6ICIwNzMwZTJjYy1mYzA4LTQxMDMtOTMwNy1jMThjYWY5OGI4OGUifQ.kpCQfin0KFC8olEju1qVqDH14nlSzGgqjAWpl1k7RUI)\nfrom an API Endpoint created from the Data Source the `pytest-tinybird` plugin populates.\n","description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://github.com/jlmadurga/pytest-tinybird","keywords":null,"license":"MIT","license_expression":null,"license_files":null,"maintainer":null,"maintainer_email":null,"name":"pytest-tinybird","package_url":"https://pypi.org/project/pytest-tinybird/","platform":null,"project_url":"https://pypi.org/project/pytest-tinybird/","project_urls":{"Homepage":"https://github.com/jlmadurga/pytest-tinybird"},"provides_extra":null,"release_url":"https://pypi.org/project/pytest-tinybird/0.3.0/","requires_dist":["pytest>=3.8.0","requests>=2.28.1"],"requires_python":null,"summary":"A pytest plugin to report test results to tinybird","version":"0.3.0","yanked":false,"yanked_reason":null},"last_serial":24789607,"releases":{"0.1.0":[{"comment_text":"","digests":{"blake2b_256":"0c30c3732e3da3f33f2a664a7e700cc47bd254ec219828aea7c612a2c11f711c","md5":"bbc973df87f78fc1cc0709816877d183","sha256":"db105de492a8261c42383c12d16b8801799f13e96137a5e91539c2e47738f768"},"downloads":-1,"filename":"pytest_tinybird-0.1.0-py3.10.egg","has_sig":false,"md5_digest":"bbc973df87f78fc1cc0709816877d183","packagetype":"bdist_egg","python_version":"0.1.0","requires_python":null,"size":7087,"upload_time":"2023-06-26T15:51:55","upload_time_iso_8601":"2023-06-26T15:51:55.454618Z","url":"https://files.pythonhosted.org/packages/0c/30/c3732e3da3f33f2a664a7e700cc47bd254ec219828aea7c612a2c11f711c/pytest_tinybird-0.1.0-py3.10.egg","yanked":false,"yanked_reason":null}],"0.2.0":[{"comment_text":"","digests":{"blake2b_256":"7dde97b3fa8be641599a079583a951b1e3e340fee748927057f21da64ea7a107","md5":"b5eb6bc4f7a603335bbafe0f2e9f6592","sha256":"7a2aca479a8f224945f4eb5225202914b7df4490fdf34ac6f9d4934744fdda0e"},"downloads":-1,"filename":"pytest_tinybird-0.2.0-py3-none-any.whl","has_sig":false,"md5_digest":"b5eb6bc4f7a603335bbafe0f2e9f6592","packagetype":"bdist_wheel","python_version":"py3","requires_python":null,"size":5225,"upload_time":"2023-06-26T15:51:53","upload_time_iso_8601":"2023-06-26T15:51:53.716917Z","url":"https://files.pythonhosted.org/packages/7d/de/97b3fa8be641599a079583a951b1e3e340fee748927057f21da64ea7a107/pytest_tinybird-0.2.0-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"281a9348ef2518962f4d91756edb8070de1875f5a10eb81f6feb104e2cf511bc","md5":"ab9f028716eedac5f7ae2f69e5e5eb53","sha256":"66659b5766af0f74665a8b62037785bebb648111cd1b0f7417dd2a5d0e166723"},"downloads":-1,"filename":"pytest-tinybird-0.2.0.tar.gz","has_sig":false,"md5_digest":"ab9f028716eedac5f7ae2f69e5e5eb53","packagetype":"sdist","python_version":"source","requires_python":null,"size":5116,"upload_time":"2023-06-26T15:51:56","upload_time_iso_8601":"2023-06-26T15:51:56.407540Z","url":"https://files.pythonhosted.org/packages/28/1a/9348ef2518962f4d91756edb8070de1875f5a10eb81f6feb104e2cf511bc/pytest-tinybird-0.2.0.tar.gz","yanked":false,"yanked_reason":null}],"0.3.0":[{"comment_text":"","digests":{"blake2b_256":"a4f286065684bb62ee1f671e37e49c3fd904821656fe7339942847d71bcd5a28","md5":"80630bb938602be909e35b2aeaede9f6","sha256":"539f23b4a55fff647ad9727cae41941bde8c958c4b305d57d4f47b06bdcf8868"},"downloads":-1,"filename":"pytest_tinybird-0.3.0-py3-none-any.whl","has_sig":false,"md5_digest":"80630bb938602be909e35b2aeaede9f6","packagetype":"bdist_wheel","python_version":"py3","requires_python":null,"size":5943,"upload_time":"2024-08-29T09:05:59","upload_time_iso_8601":"2024-08-29T09:05:59.205244Z","url":"https://files.pythonhosted.org/packages/a4/f2/86065684bb62ee1f671e37e49c3fd904821656fe7339942847d71bcd5a28/pytest_tinybird-0.3.0-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"004236a33bc6df217dfd05092ad797a06db77a6838a0abba78b0d9fa94a795ca","md5":"44f5c4da72da33cc3a94e7994b03f4ca","sha256":"bbf5f6d3453c13af8413412585fc5bc3062c630762fdc03c3b2eb31ad597e7d4"},"downloads":-1,"filename":"pytest_tinybird-0.3.0.tar.gz","has_sig":false,"md5_digest":"44f5c4da72da33cc3a94e7994b03f4ca","packagetype":"sdist","python_version":"source","requires_python":null,"size":5874,"upload_time":"2024-08-29T09:06:00","upload_time_iso_8601":"2024-08-29T09:06:00.443765Z","url":"https://files.pythonhosted.org/packages/00/42/36a33bc6df217dfd05092ad797a06db77a6838a0abba78b0d9fa94a795ca/pytest_tinybird-0.3.0.tar.gz","yanked":false,"yanked_reason":null}]},"urls":[{"comment_text":"","digests":{"blake2b_256":"a4f286065684bb62ee1f671e37e49c3fd904821656fe7339942847d71bcd5a28","md5":"80630bb938602be909e35b2aeaede9f6","sha256":"539f23b4a55fff647ad9727cae41941bde8c958c4b305d57d4f47b06bdcf8868"},"downloads":-1,"filename":"pytest_tinybird-0.3.0-py3-none-any.whl","has_sig":false,"md5_digest":"80630bb938602be909e35b2aeaede9f6","packagetype":"bdist_wheel","python_version":"py3","requires_python":null,"size":5943,"upload_time":"2024-08-29T09:05:59","upload_time_iso_8601":"2024-08-29T09:05:59.205244Z","url":"https://files.pythonhosted.org/packages/a4/f2/86065684bb62ee1f671e37e49c3fd904821656fe7339942847d71bcd5a28/pytest_tinybird-0.3.0-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"004236a33bc6df217dfd05092ad797a06db77a6838a0abba78b0d9fa94a795ca","md5":"44f5c4da72da33cc3a94e7994b03f4ca","sha256":"bbf5f6d3453c13af8413412585fc5bc3062c630762fdc03c3b2eb31ad597e7d4"},"downloads":-1,"filename":"pytest_tinybird-0.3.0.tar.gz","has_sig":false,"md5_digest":"44f5c4da72da33cc3a94e7994b03f4ca","packagetype":"sdist","python_version":"source","requires_python":null,"size":5874,"upload_time":"2024-08-29T09:06:00","upload_time_iso_8601":"2024-08-29T09:06:00.443765Z","url":"https://files.pythonhosted.org/packages/00/42/36a33bc6df217dfd05092ad797a06db77a6838a0abba78b0d9fa94a795ca/pytest_tinybird-0.3.0.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[]}
